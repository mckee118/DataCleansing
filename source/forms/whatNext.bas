Version =20
VersionRequired =20
PublishOption =1
    Modal = NotDefault
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =13889
    DatasheetFontHeight =11
    ItemSuffix =3
    Top =600
    Right =13890
    Bottom =8520
    DatasheetGridlinesColor =14806254
        0x4434ba7b0064e440
    End
    Caption ="What's next?"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Calibri"
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            Width =1701
            Height =1701
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
            Height =7937
            BackColor =15590879
            Name ="Detail"
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
                    BackStyle =1
                    OverlapFlags =85
                    Left =7086
                    Top =2664
                    Width =4980
                    Height =465
                    FontSize =18
                    FontWeight =700
                    BackColor =12349952
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="Label0"
                    Caption ="What would you like to do next?"
                    GridlineColor =10921638
                    LayoutCachedLeft =7086
                    LayoutCachedTop =2664
                    LayoutCachedWidth =12066
                    LayoutCachedHeight =3129
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =1
                    ForeTint =100.0
                End
                    PictureType =2
                    Left =7485
                    Width =4350
                    Height =2250
                    BorderColor =10921638
                    Name ="Image3"
                    Picture ="Logo_transparent"
                    GridlineColor =10921638

                    LayoutCachedLeft =7485
                    LayoutCachedWidth =11835
                    LayoutCachedHeight =2250
                    TabIndex =3
                End
                    OverlapFlags =85
                    Left =6349
                    Top =3628
                    Width =2892
                    Height =900
                    FontSize =16
                    FontWeight =700
                    ForeColor =6373413
                    Name ="Command4"
                    Caption ="View Match Summary"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =6349
                    LayoutCachedTop =3628
                    LayoutCachedWidth =9241
                    LayoutCachedHeight =4528
                    ForeThemeColorIndex =4
                    ForeTint =100.0
                    ForeShade =50.0
                    Gradient =0
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =16051931
                    HoverThemeColorIndex =8
                    HoverTint =20.0
                    PressedColor =9592887
                    HoverForeColor =6373413
                    HoverForeThemeColorIndex =4
                    HoverForeTint =100.0
                    HoverForeShade =50.0
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                    OverlapFlags =85
                    Left =10148
                    Top =3628
                    Width =2892
                    Height =900
                    FontSize =16
                    FontWeight =700
                    TabIndex =1
                    ForeColor =6373413
                    Name ="Command1"
                    Caption ="View Interactive Matching"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =10148
                    LayoutCachedTop =3628
                    LayoutCachedWidth =13040
                    LayoutCachedHeight =4528
                    ForeThemeColorIndex =4
                    ForeTint =100.0
                    ForeShade =50.0
                    Gradient =0
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =16051931
                    HoverThemeColorIndex =8
                    HoverTint =20.0
                    PressedColor =9592887
                    HoverForeColor =6373413
                    HoverForeThemeColorIndex =4
                    HoverForeTint =100.0
                    HoverForeShade =50.0
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                    OverlapFlags =85
                    Left =8163
                    Top =4875
                    Width =2892
                    Height =570
                    FontSize =16
                    FontWeight =700
                    TabIndex =2
                    ForeColor =6373413
                    Name ="Command2"
                    Caption ="Start Over"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =8163
                    LayoutCachedTop =4875
                    LayoutCachedWidth =11055
                    LayoutCachedHeight =5445
                    ForeThemeColorIndex =4
                    ForeTint =100.0
                    ForeShade =50.0
                    Gradient =0
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =16051931
                    HoverThemeColorIndex =8
                    HoverTint =20.0
                    PressedColor =9592887
                    HoverForeColor =6373413
                    HoverForeThemeColorIndex =4
                    HoverForeTint =100.0
                    HoverForeShade =50.0
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Public strTable As String
Public uprnCount As String

Public Sub ChangePTStatement(p_QueryName As String, p_sql As String)
'for changing pass-through's in this db
'dark11984 Access Forums
    Dim qdef As DAO.QueryDef
 
    Set qdef = CurrentDb.QueryDefs(p_QueryName)
    qdef.sql = p_sql
    qdef.Close
    Set qdef = Nothing
 
End Sub

Private Sub Command1_Click()
    Dim strSQL As String
    
       strSQL = "SELECT a.address1, a.address2, a.address3, a.address4, a.address5, a.postcode AS addPostcode, a.uprn AS addUPRN, " & _
       "p.building_number, p.primary_thorfare, p.townland, p.town, p.county, p.postcode AS POINTPostcode, p.uprn AS POINTUPRN " & _
       "FROM " & strTable & " AS a INNER JOIN POINTER AS p ON a.uprn = p.uprn"
       
       ChangePTStatement "getUPRNMatches", strSQL
       
       DoCmd.OpenForm "compareUPCID", , , , , , strTable
            
       Forms!compareUPCID!Label16.Caption = strTable & " Data"
       
       statusmsg = SysCmd(acSysCmdSetStatus, "Viewing the successful matches interactively")
       
End Sub

Private Sub Command2_Click()
DoCmd.Close
statusmsg = SysCmd(acSysCmdSetStatus, "Select a table from the drop-down box of for more information click 'i'")
End Sub

Private Sub Command4_Click()
DoCmd.OpenForm "matchSummary"

Forms!matchSummary!totalRecords.Caption = DLookup("counter", "countRowsAddress")
Forms!matchSummary!nullUPRNs.Caption = uprnCount
Forms!matchSummary!matchedUPRNs.Caption = uprnCount - (DLookup("col", "countUPRN"))
Forms!matchSummary!uprnsStillNull.Caption = DLookup("col", "countUPRN")
Forms!matchSummary!percentageMatched.Caption = Round(((uprnCount - (DLookup("col", "countUPRN"))) / DLookup("counter", "countRowsAddress")) * 100, 2) & "%"
Forms!matchSummary!title.Caption = "Matching summary for " & strTable

statusmsg = SysCmd(acSysCmdSetStatus, "Viewing the summary of the matching process.")

End Sub

Private Sub Form_Open(Cancel As Integer)

 Dim argPos As Integer

  If Len(Me.OpenArgs) > 0 Then

    argPos = InStr(Me.OpenArgs, "|")

    If argPos > 0 Then


      strTable = Left$(Me.OpenArgs, argPos - 1)

      uprnCount = Mid$(Me.OpenArgs, argPos + 1)

    End If
  End If

End Sub
