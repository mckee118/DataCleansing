Version =20
VersionRequired =20
PublishOption =1
    Modal = NotDefault
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =18822
    DatasheetFontHeight =11
    ItemSuffix =6
    Left =360
    Top =360
    Right =16440
    Bottom =9165
    DatasheetGridlinesColor =14806254
        0x1f739f21f762e440
    End
    Caption ="Table Selection"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Calibri"
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            Width =1701
            Height =1701
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
            AddColon = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            SpecialEffect =2
            OldBorderStyle =1
            Width =4536
            Height =2835
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            Height =10148
            BackColor =15590879
            Name ="Detail"
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
                    SpecialEffect =0
                    BackStyle =1
                    OldBorderStyle =0
                    OverlapFlags =93
                    Left =7155
                    Top =4200
                    Width =6852
                    Height =567
                    BackColor =12419407
                    BorderColor =10921638
                    Name ="Box0"
                    GridlineColor =10921638
                    LayoutCachedLeft =7155
                    LayoutCachedTop =4200
                    LayoutCachedWidth =14007
                    LayoutCachedHeight =4767
                    BackThemeColorIndex =4
                End
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =10957
                    Top =4318
                    Width =2320
                    Height =330
                    FontSize =14
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"10\";\"256\""
                    Name ="Combo8"
                    RowSourceType ="Table/Query"
                    RowSource ="getTables"
                    OnChange ="[Event Procedure]"
                    ControlTipText ="Click to select a table"
                    GridlineColor =10921638

                    LayoutCachedLeft =10957
                    LayoutCachedTop =4318
                    LayoutCachedWidth =13277
                    LayoutCachedHeight =4648
                    ForeThemeColorIndex =0
                    ForeShade =100.0
                            OverlapFlags =215
                            Left =7725
                            Top =4318
                            Width =3105
                            Height =330
                            FontSize =14
                            BorderColor =8355711
                            ForeColor =16777215
                            Name ="Label11"
                            Caption ="Select a table to configure: "
                            GridlineColor =10921638
                            LayoutCachedLeft =7725
                            LayoutCachedTop =4318
                            LayoutCachedWidth =10830
                            LayoutCachedHeight =4648
                            ForeThemeColorIndex =1
                            ForeTint =100.0
                        End
                    End
                End
                    Visible = NotDefault
                    OverlapFlags =85
                    TextAlign =2
                    Left =7155
                    Top =4888
                    Width =6855
                    Height =825
                    FontSize =16
                    FontWeight =700
                    BorderColor =8355711
                    ForeColor =8210719
                    Name ="RecordCount"
                    Caption ="There are 7,404,079 records in the Address table"
                    GridlineColor =10921638
                    LayoutCachedLeft =7155
                    LayoutCachedTop =4888
                    LayoutCachedWidth =14010
                    LayoutCachedHeight =5713
                    ForeThemeColorIndex =2
                    ForeTint =100.0
                End
                    PictureType =2
                    Left =8445
                    Width =4350
                    Height =2250
                    BorderColor =10921638
                    Name ="Image3"
                    Picture ="Logo_transparent"
                    GridlineColor =10921638

                    LayoutCachedLeft =8445
                    LayoutCachedWidth =12795
                    LayoutCachedHeight =2250
                    TabIndex =2
                End
                    OverlapFlags =85
                    Left =16560
                    Top =6870
                    Width =1927
                    Height =511
                    FontSize =16
                    FontWeight =700
                    TabIndex =1
                    ForeColor =6373413
                    Name ="Command4"
                    Caption ="Next >>"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click to continue"
                    GridlineColor =10921638

                    LayoutCachedLeft =16560
                    LayoutCachedTop =6870
                    LayoutCachedWidth =18487
                    LayoutCachedHeight =7381
                    ForeThemeColorIndex =4
                    ForeTint =100.0
                    ForeShade =50.0
                    Gradient =0
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =16051931
                    HoverThemeColorIndex =8
                    HoverTint =20.0
                    PressedColor =9592887
                    HoverForeColor =6373413
                    HoverForeThemeColorIndex =4
                    HoverForeTint =100.0
                    HoverForeShade =50.0
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                    PictureType =2
                    Left =14055
                    Top =4005
                    Width =915
                    Height =855
                    BorderColor =10921638
                    Name ="Image5"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click for information"
                    Picture ="informationButton"
                    GridlineColor =10921638

                    LayoutCachedLeft =14055
                    LayoutCachedTop =4005
                    LayoutCachedWidth =14970
                    LayoutCachedHeight =4860
                    TabIndex =3
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Public Sub ChangePTStatement(p_QueryName As String, p_sql As String)
'for changing pass-through's in this db
    Dim qdef As DAO.QueryDef
 
    Set qdef = CurrentDb.QueryDefs(p_QueryName)
    qdef.sql = p_sql
    qdef.Close
    Set qdef = Nothing
 
End Sub

Private Sub Combo8_Change()
On Error GoTo ErrorHandler:
       Dim strSQL As String
       Dim strTable As String
       Dim statusmsg As Variant
       statusmsg = SysCmd(acSysCmdRemoveMeter)
       
       strTable = Combo8.Value 'set this to the value in dropdown list
    
       strSQL = "SELECT Count(*) AS counter" & vbNewLine & "FROM " & strTable
       
       'call the pass through function
       ChangePTStatement "countRowsAddress", strSQL

       statusmsg = SysCmd(acSysCmdSetStatus, "Running extensive query, please wait...")

       'Open the Msg Form, Pass a msg using OpenArgs
       DoCmd.OpenForm "frmCustomMSG"
       DoCmd.SetWarnings (False)   'Turn off default warning msg
            
       RecordCount.Caption = "There are " & Format(DLookup("[counter]", "countRowsAddress"), "##,##") & " records in the " & strTable & " table"
       RecordCount.Visible = True
       
       Application.SysCmd acSysCmdClearStatus
       
       DoCmd.SetWarnings (True)    'Turn on default warning msg
       'Close the Msg Form
       DoCmd.Close acForm, "frmCustomMSG", acSaveNo

       
Exit Sub
ErrorHandler:
    MsgBox "An error occured -  error  " & Err.Number & ": " & Err.Description
End Sub

Private Sub Command4_Click()

On Error GoTo ErrorHandler:
       Dim strSQL As String
       Dim strTable As String
       
       strTable = Combo8.Value 'set this to the value in dropdown list
          
       'Forms!selectUPCIDs!List0.RowSourceType = "Table/Query"
       
       strSQL = "SELECT COLUMN_NAME FROM [INFORMATION_SCHEMA].COLUMNS WHERE COLUMN_NAME LIKE 'upcid%' AND TABLE_NAME = '" & strTable & "'"

       'call the pass through function
       ChangePTStatement "getUPCIDColumns", strSQL

       DoCmd.OpenForm "selectUPCIDs", , , , , , Combo8.Value

       Forms!selectUPCIDs!Text7.Value = "create"
       
       Forms!selectUPCIDs!Text11.Value = "Select UPCID Columns to add to the table " & strTable
           
    Exit Sub
ErrorHandler:
    MsgBox "An error occured -  error  " & Err.Number & ": " & Err.Description

End Sub

Private Sub Form_Open(Cancel As Integer)
DoCmd.Maximize
End Sub

Private Sub Image5_Click()

DoCmd.OpenForm "moreInformation"

Forms!moreInformation.infoText.Caption = "Select a table from the drop down box provided (you will have to sign into the database through the pop up when prompted if you have not already done so), a message below the drop down box will display the number of records contained in that table. When you have selected the table you wish to use, simply click the next button."

End Sub
