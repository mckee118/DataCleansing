Version =20
VersionRequired =20
PublishOption =1
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =11565
    DatasheetFontHeight =11
    ItemSuffix =18
    Right =16665
    Bottom =7890
    DatasheetGridlinesColor =14806254
        0x87b0563c9b51e440
    End
    DatasheetFontName ="Calibri"
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            BorderLineStyle =0
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            AddColon = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
            Height =7149
            Name ="Detail"
            AutoHeight =1
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
                    BackStyle =1
                    OverlapFlags =93
                    Left =6519
                    Top =1133
                    Width =4757
                    Height =2948
                    BackColor =7961551
                    BorderColor =10921638
                    Name ="Box13"
                    GridlineColor =10921638
                    LayoutCachedLeft =6519
                    LayoutCachedTop =1133
                    LayoutCachedWidth =11276
                    LayoutCachedHeight =4081
                    BackThemeColorIndex =-1
                End
                    BackStyle =1
                    OverlapFlags =93
                    Left =340
                    Top =1133
                    Width =6122
                    Height =2948
                    BackColor =6405021
                    BorderColor =10921638
                    Name ="Box12"
                    GridlineColor =10921638
                    LayoutCachedLeft =340
                    LayoutCachedTop =1133
                    LayoutCachedWidth =6462
                    LayoutCachedHeight =4081
                    BackThemeColorIndex =-1
                End
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =340
                    Top =170
                    Width =7185
                    Height =825
                    FontSize =16
                    BorderColor =8355711
                    Name ="RecordCount"
                    Caption ="There are 7,404,079 records in the Address table"
                    GridlineColor =10921638
                    LayoutCachedLeft =340
                    LayoutCachedTop =170
                    LayoutCachedWidth =7525
                    LayoutCachedHeight =995
                    ForeTint =100.0
                End
                    OverlapFlags =215
                    Left =3345
                    Top =1920
                    Width =2324
                    Height =630
                    ForeColor =4210752
                    Name ="Command1"
                    Caption ="Create MatchKey columns to AddressData"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =3345
                    LayoutCachedTop =1920
                    LayoutCachedWidth =5669
                    LayoutCachedHeight =2550
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =15060409
                    PressedColor =9592887
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                    OverlapFlags =215
                    Left =7710
                    Top =1920
                    Width =2324
                    Height =630
                    TabIndex =1
                    ForeColor =4210752
                    Name ="Command3"
                    Caption ="Create MatchKey columns to POINTER"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =7710
                    LayoutCachedTop =1920
                    LayoutCachedWidth =10034
                    LayoutCachedHeight =2550
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =15060409
                    PressedColor =9592887
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                    OverlapFlags =215
                    Left =3345
                    Top =2884
                    Width =2324
                    Height =630
                    TabIndex =2
                    ForeColor =4210752
                    Name ="Command4"
                    Caption ="Add MatchKeys to AddressData"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =3345
                    LayoutCachedTop =2884
                    LayoutCachedWidth =5669
                    LayoutCachedHeight =3514
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =15060409
                    PressedColor =9592887
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                    OverlapFlags =215
                    Left =7710
                    Top =2884
                    Width =2324
                    Height =630
                    TabIndex =3
                    ForeColor =4210752
                    Name ="Command5"
                    Caption ="Add MatchKeys to POINTER"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =7710
                    LayoutCachedTop =2884
                    LayoutCachedWidth =10034
                    LayoutCachedHeight =3514
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =15060409
                    PressedColor =9592887
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =3345
                    Top =1247
                    Width =2380
                    Height =315
                    TabIndex =4
                    BorderColor =10921638
                    ForeColor =4138256
                    ColumnInfo ="\"\";\"\";\"10\";\"256\""
                    Name ="Combo8"
                    RowSourceType ="Table/Query"
                    RowSource ="getTables"
                    OnChange ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =3345
                    LayoutCachedTop =1247
                    LayoutCachedWidth =5725
                    LayoutCachedHeight =1562
                End
                    OverlapFlags =85
                    Left =8447
                    Top =4535
                    Width =2324
                    Height =624
                    TabIndex =5
                    ForeColor =4210752
                    Name ="Command10"
                    Caption ="Match"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =8447
                    LayoutCachedTop =4535
                    LayoutCachedWidth =10771
                    LayoutCachedHeight =5159
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =15060409
                    PressedColor =9592887
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                    OverlapFlags =215
                    Left =623
                    Top =1247
                    Width =2595
                    Height =285
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="Label11"
                    Caption ="Select a table to configure: "
                    GridlineColor =10921638
                    LayoutCachedLeft =623
                    LayoutCachedTop =1247
                    LayoutCachedWidth =3218
                    LayoutCachedHeight =1532
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Public Sub ChangePTStatement(p_QueryName As String, p_sql As String)
'for changing pass-through's in this db
    Dim qdef As DAO.QueryDef
 
    Set qdef = CurrentDb.QueryDefs(p_QueryName)
    qdef.sql = p_sql
    qdef.Close
    Set qdef = Nothing
 
End Sub

Private Sub Combo8_Change()
On Error GoTo ErrorHandler:
       Dim strSQL As String
       Dim strTable As String
       strTable = Combo8.Value 'set this to the value in dropdown list
    
       strSQL = "SELECT Count(*) AS counter" & vbNewLine & "FROM " & strTable
       
       'call the pass through function
       ChangePTStatement "countRowsAddress", strSQL
       RecordCount.Caption = "There are " & Format(DLookup("[counter]", "countRowsAddress"), "##,##") & " records in the " & strTable & " table"
       RecordCount.Visible = True
       
Exit Sub
ErrorHandler:
    MsgBox "An error occured -  error  " & Err.Number & ": " & Err.Description
End Sub

Private Sub Command1_Click()
    On Error GoTo ErrorHandler:

       Dim strSQL As String
       Dim strTable As String
       
       strTable = Combo8.Value 'set this to the value in dropdown list
          
       'Forms!selectUPCIDs!List0.RowSourceType = "Table/Query"
       
       strSQL = "SELECT COLUMN_NAME FROM [INFORMATION_SCHEMA].COLUMNS WHERE COLUMN_NAME LIKE 'upcid%' AND TABLE_NAME = '" & strTable & "'"

       'call the pass through function
       ChangePTStatement "getUPCIDColumns", strSQL

       DoCmd.OpenForm "selectUPCIDs"
          
       Forms!selectUPCIDs!Text7.Value = "create"
       
       'Me.Command1.Enabled = False
             
    Exit Sub
ErrorHandler:
    MsgBox "An error occured -  error  " & Err.Number & ": " & Err.Description
End Sub

Private Sub Command10_Click()
    On Error GoTo ErrorHandler:
       Dim strSQL As String
       Dim strTable As String
       strTable = Combo8.Value 'set this to the value in your dropdown list
    
       
       
       'call the pass through function
       'ChangePTStatement "addUPRN", strSQL
       
       DoCmd.SetWarnings (False)
       DoCmd.OpenQuery ("addUPRN")
       MsgBox "UPRNs Added", vbOKOnly, "Complete!"
       DoCmd.SetWarnings (True)
       DoCmd.OpenForm ("CompareUPCID")
       Me.Command10.Enabled = False
    Exit Sub
ErrorHandler:
    MsgBox "An error occured -  error  " & Err.Number & ": " & Err.Description
End Sub

Private Sub Command3_Click()
    On Error GoTo ErrorHandler:
        DoCmd.SetWarnings (False)
        DoCmd.OpenQuery ("createUPCIDsPOINTER")
        MsgBox "Columns Created", vbOKOnly, "Complete!"
        DoCmd.SetWarnings (True)
        Me.Command3.Enabled = False
    Exit Sub
ErrorHandler:
    MsgBox "An error occured -  error  " & Err.Number & ": " & Err.Description
End Sub

Private Sub Command4_Click()
    On Error GoTo ErrorHandler:
       Dim strSQL As String
       Dim strSQLDefault As String
       Dim strTable As String
       strTable = Combo8.Value 'set this to the value in your dropdown list
       
       strSQL = "SELECT COLUMN_NAME"
       strSQL = strSQL & " FROM [INFORMATION_SCHEMA].COLUMNS"
       strSQL = strSQL & " WHERE COLUMN_NAME LIKE 'upcid%' AND TABLE_NAME = " & "'" & strTable & "'"
       
       'call the pass through function
       ChangePTStatement "getUPCIDColumns", strSQL
       
       
       DoCmd.OpenForm "selectUPCIDs"
          
       Forms!selectUPCIDs!List0.RowSourceType = "Table/Query"
       Forms!selectUPCIDs!List0.RowSource = "getUPCIDColumns"
       
       Forms!selectUPCIDs!Text7.Value = "add"
       
       'strSQLDefault = "Update " & strTable
       'strSQL = strSQLDefault & " set upcid_n_wp = REPLACE(DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'numbers') + ISNULL(POSTCODE, ''), ' ', '')"
       'strSQL = strSQL & strSQLDefault & " set upcid_n_np = REPLACE(DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, '')+ISNULL(POSTCODE, ''), 'numbers'), ' ', '')"
       'strSQL = strSQL & strSQLDefault & " set upcid_ws_wp = dbo.unwanted(REPLACE(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, '')+ISNULL(POSTCODE, ''), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_ws_np = dbo.unwanted(REPLACE(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, '')+DBO.fn_extract_chars(ISNULL(POSTCODE, ''), 'numbers'), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_cs_wp = dbo.unwanted(REPLACE(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'letters') + ISNULL(POSTCODE, ''), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_cs_np = dbo.unwanted(REPLACE(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'letters')+POINTER.DBO.fn_extract_chars(ISNULL(POSTCODE, ''), 'numbers'), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_n_nvd_wp = dbo.unwanted(REPLACE(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'numbers')+CENSUS2011.DBO.nvd(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, '')) +ISNULL(POSTCODE, ''), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_n_nvd_np = dbo.unwanted(REPLACE(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'numbers')+CENSUS2011.DBO.nvd(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, '')) +POINTER.DBO.fn_extract_chars(ISNULL(POSTCODE, ''), 'numbers'), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_nvd_wp = dbo.unwanted(REPLACE(CENSUS2011.DBO.nvd(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, '')) +ISNULL(POSTCODE, ''), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_nvd_np = dbo.unwanted(REPLACE(CENSUS2011.DBO.nvd(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, '')) +POINTER.DBO.fn_extract_chars(ISNULL(POSTCODE, ''), 'numbers'), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_n_fc_wp = dbo.unwanted(REPLACE(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'numbers')+LEFT(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'letters'), 1)+ISNULL(POSTCODE, ''), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_n_fc_np = dbo.unwanted(REPLACE(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'numbers')+LEFT(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'letters'), 1)+POINTER.DBO.fn_extract_chars(ISNULL(POSTCODE, ''), 'numbers'), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_n_3c_wp = dbo.unwanted(REPLACE(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'numbers')+LEFT(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'letters'), 3)+ISNULL(POSTCODE, ''), ' ', ''))"
       'strSQL = strSQL & strSQLDefault & " set upcid_n_3c_np = dbo.unwanted(REPLACE(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'numbers')+LEFT(POINTER.DBO.fn_extract_chars(ISNULL(Address1, '')+ISNULL(Address2, '')+ISNULL(Address3, '')+ISNULL(Address4, ''), 'letters'), 3)+POINTER.DBO.fn_extract_chars(ISNULL(POSTCODE, ''), 'numbers'), ' ', ''))"
       
       'call the pass through function
       'ChangePTStatement "addUPCIDsAddress", strSQL
       
        'DoCmd.SetWarnings (False)
        'DoCmd.OpenQuery ("addUPCIDsAddress")
        'MsgBox "UPCIDs Added", vbOKOnly, "Complete"
        'DoCmd.SetWarnings (True)
        'Me.Command4.Enabled = False
        
    Exit Sub
ErrorHandler:
    MsgBox "An error occured -  error  " & Err.Number & ": " & Err.Description
End Sub

Private Sub Command5_Click()
    On Error GoTo ErrorHandler:
    DoCmd.SetWarnings (False)
    DoCmd.OpenQuery ("addUPCIDsPOINTER")
    MsgBox "UPCIDs Added", vbOKOnly, "Complete"
    DoCmd.SetWarnings (True)
    Me.Command5.Enabled = False
    Exit Sub
ErrorHandler:
    MsgBox "An error occured -  error  " & Err.Number & ": " & Err.Description

End Sub

Private Sub Form_Load()
    
End Sub
